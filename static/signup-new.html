<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sign Up - Home Inventory</title>
  <style>
    * {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', sans-serif;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-8px);
      }
    }

    @keyframes glow-shift {

      0%,
      100% {
        filter: drop-shadow(0 0 20px rgba(139, 92, 246, 0.4));
      }

      50% {
        filter: drop-shadow(0 0 30px rgba(236, 72, 153, 0.5));
      }
    }

    body {
      margin: 0;
      padding: 24px;
      background: linear-gradient(135deg, #0f0f1f 0%, #1a0f2e 25%, #2d1b4e 50%, #1a0f2e 75%, #0f0f1f 100%);
      background-attachment: fixed;
      min-height: 100vh;
      color: #fff;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at 20% 50%, rgba(236, 72, 153, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 50% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .card {
      position: relative;
      z-index: 1;
      max-width: 520px;
      margin: 40px auto;
      background: linear-gradient(135deg, rgba(236, 72, 153, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
      backdrop-filter: blur(40px);
      -webkit-backdrop-filter: blur(40px);
      padding: 28px;
      border-radius: 24px;
      border: 1.5px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    input {
      width: 100%;
      padding: 12px 16px;
      margin: 8px 0;
      background: rgba(255, 255, 255, 0.15);
      border: 1.5px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }

    input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(236, 72, 153, 0.8);
      box-shadow: 0 0 20px rgba(236, 72, 153, 0.4);
    }

    button {
      background: linear-gradient(135deg, rgba(236, 72, 153, 0.8) 0%, rgba(139, 92, 246, 0.8) 100%);
      color: #fff;
      padding: 12px 24px;
      border: 1.5px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      cursor: pointer;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 16px rgba(236, 72, 153, 0.4);
    }

    button:hover {
      box-shadow: 0 8px 24px rgba(236, 72, 153, 0.6);
      transform: translateY(-2px);
    }

    button:active {
      transform: translateY(0px);
    }

    .hint {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.7);
      margin-top: 12px;
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      border-left: 3px solid rgba(236, 72, 153, 0.5);
    }

    header {
      display: flex;
      align-items: center;
      gap: 12px;
      max-width: 820px;
      margin: 18px auto 6px;
      position: relative;
      z-index: 1;
    }

    a {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: #fff;
      transition: opacity 0.3s ease;
    }

    a:hover {
      opacity: 0.8;
    }

    h2 {
      margin: 0 0 8px 0;
      font-size: 28px;
      font-weight: 900;
      background: linear-gradient(135deg, rgba(236, 72, 153, 0.9) 0%, rgba(139, 92, 246, 0.9) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    p {
      margin: 0 0 14px;
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
    }

    label {
      display: block;
      margin-top: 16px;
      margin-bottom: 6px;
      font-weight: 700;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.9);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .form-group {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    .login-link {
      color: rgba(236, 72, 153, 0.9);
      font-weight: 700;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .login-link:hover {
      color: rgba(236, 72, 153, 1);
      text-shadow: 0 0 10px rgba(236, 72, 153, 0.6);
    }

    .logo-glow {
      animation: glow-shift 3s ease-in-out infinite;
    }

    svg {
      filter: drop-shadow(0 0 15px rgba(139, 92, 246, 0.4));
    }
  </style>
</head>

<body>
  <header>
    <a href="/">
      <svg class="logo-glow" width="42" height="42" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 9.5L12 3l9 6.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V9.5z" stroke="url(#grad)"
          stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
        <defs>
          <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#ec4899;stop-opacity:1" />
            <stop offset="50%" style="stop-color:#8b5cf6;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1" />
          </linearGradient>
        </defs>
      </svg>
      <div
        style="font-weight: 900; font-size: 20px; background: linear-gradient(135deg, #ec4899, #8b5cf6, #3b82f6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
        Home Inventory
      </div>
    </a>
  </header>

  <div class="card">
    <h2>Create your account üöÄ</h2>
    <p>Join the community and organize your inventory with liquid glass style</p>
    <form id="signupForm">
      <label>Full Name</label>
      <input id="full_name" type="text" placeholder="John Doe" required />

      <label>Email</label>
      <input id="email" type="email" placeholder="your@email.com" required />

      <label>Password</label>
      <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required maxlength="128" />

      <div class="form-group">
        <button type="submit">Sign Up ‚ú®</button>
        <a id="loginLink" href="/auth/login-page" class="login-link">Already have an account?</a>
      </div>
      <div id="msg" class="hint"></div>
    </form>
  </div>

  <script>
    const API = "https://home-inventory-production.up.railway.app";
    const form = document.getElementById('signupForm');
    const msg = document.getElementById('msg');
    // If there's a next param, append it to the login link so users can return after logging in
    try { const p = new URLSearchParams(window.location.search); const n = p.get('next'); if (n) { const l = document.getElementById('loginLink'); if (l) l.href = '/auth/login-page?next=' + encodeURIComponent(n); } } catch (e) { }
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.textContent = '';
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const full_name = document.getElementById('full_name').value;
      try {
        const res = await fetch(API + '/auth/signup', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password, full_name })
        });
        if (!res.ok) {
          const d = await res.json().catch(() => ({ detail: res.statusText }));
          msg.textContent = '‚ö†Ô∏è Signup failed: ' + (d.detail || res.statusText || res.status);
          msg.style.borderLeftColor = 'rgba(239, 68, 68, 0.8)';
          return;
        }
        const created = await res.json();
        // after successful signup, auto-login
        const loginRes = await fetch(API + '/auth/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });
        if (!loginRes.ok) {
          msg.textContent = '‚ö†Ô∏è Signup succeeded but auto-login failed';
          msg.style.borderLeftColor = 'rgba(239, 68, 68, 0.8)';
          return;
        }
        const tokenData = await loginRes.json();
        if (tokenData && tokenData.access_token) {
          localStorage.setItem('access_token', tokenData.access_token);
          msg.textContent = '‚úÖ Welcome aboard! Redirecting...';
          msg.style.borderLeftColor = 'rgba(34, 197, 94, 0.8)';
          // redirect to next (if present) or root
          try {
            const params = new URLSearchParams(window.location.search);
            let next = params.get('next') || '/';
            if (!next.startsWith('/')) next = '/';
            setTimeout(() => window.location.href = next, 800);
          } catch (e) {
            setTimeout(() => window.location.href = '/', 800);
          }
        } else {
          msg.textContent = '‚ö†Ô∏è Signup completed but token missing';
          msg.style.borderLeftColor = 'rgba(239, 68, 68, 0.8)';
        }
      } catch (err) {
        msg.textContent = '‚ö†Ô∏è Network error: ' + err.message;
        msg.style.borderLeftColor = 'rgba(239, 68, 68, 0.8)';
      }
    });
  </script>
</body>

</html>